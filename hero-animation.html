<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hero Animation - Frame Scroll</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap');
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Cairo', sans-serif;
      background: #000;
      overflow-x: hidden;
    }
    
    .hero-container {
      position: relative;
      width: 100%;
      height: 500vh;
    }
    
    .sticky-wrapper {
      position: sticky;
      top: 0;
      height: 100vh;
      width: 100%;
      overflow: hidden;
      border-bottom-left-radius: 20px;
      border-bottom-right-radius: 20px;
    }
    
    #hero-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }
    
    .text-overlay {
      position: absolute;
      top: 75%;
      right: 0;
      transform: translateY(-50%);
      width: 100%;
      z-index: 50;
      padding-right: 30px;
      padding-left: 30px;
      text-shadow: 0 4px 30px rgba(0, 0, 0, 0.5), 0 2px 10px rgba(0, 0, 0, 0.3);
    }
    
    .text-container {
      position: relative;
      line-height: 1.2;
      color: white;
      font-weight: 800;
    }
    
    .text-slide {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .text-slide.active {
      opacity: 1;
    }
    
    .text-slide span {
      display: inline-block;
      margin-left: 8px;
    }
    
    .scroll-tooltip {
      position: fixed;
      right: 40px;
      top: 9px;
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 8px;
      opacity: 0;
      transform: translateX(15px) translateY(15px);
      transition: opacity 0.5s ease, transform 0.5s ease;
      pointer-events: none;
    }
    
    .scroll-tooltip.visible {
      opacity: 1;
      transform: translateX(0) translateY(0);
    }
    
    .tooltip-badge {
      background: #C1A01E;
      color: black;
      padding: 8px 16px;
      border-radius: 9999px;
      font-size: 14px;
      font-weight: 500;
      white-space: nowrap;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    
    @media (min-width: 768px) {
      .text-overlay {
        padding-right: 120px;
        top: 75%;
      }
      
      .text-container {
        font-size: 72px;
        letter-spacing: -2px;
      }
      
      .text-slide span {
        margin-left: 16px;
      }
    }
    
    @media (min-width: 1280px) {
      .text-container {
        font-size: 90px;
      }
    }
    
    @media (max-width: 767px) {
      .text-container {
        font-size: 37px;
      }
      
      .scroll-tooltip {
        display: none;
      }
    }
    
    /* Loading indicator */
    .loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 18px;
      z-index: 10;
    }
  </style>
</head>
<body>
  <!-- Scroll Tooltip -->
  <div id="scroll-tooltip" class="scroll-tooltip">
    <div class="tooltip-badge">مرر للاستكشاف</div>
  </div>

  <!-- Hero Section -->
  <section id="hero-section" class="hero-container">
    <div class="sticky-wrapper">
      <canvas id="hero-canvas"></canvas>
      <div id="loading" class="loading">جاري التحميل...</div>
      
      <!-- Text Overlay -->
      <div class="text-overlay">
        <div class="text-container">
          <!-- Text Slide 1 -->
          <div class="text-slide" data-slide="0">
            <div>
              <span>لا</span>
              <span>نبني</span>
              <span>مجرد</span>
              <span>هياكل</span>
            </div>
            <div>
              <span>بل</span>
              <span>نبني</span>
              <span>إرثاً</span>
              <span>يدوم.</span>
            </div>
          </div>
          
          <!-- Text Slide 2 -->
          <div class="text-slide" data-slide="1">
            <div>
              <span>كل</span>
              <span>مشروع</span>
              <span>ننجزه</span>
            </div>
            <div>
              <span>هو</span>
              <span>وعد</span>
              <span>نلتزم</span>
              <span>به.</span>
            </div>
          </div>
          
          <!-- Text Slide 3 -->
          <div class="text-slide" data-slide="2">
            <div>
              <span>نبني</span>
              <span>بهدف</span>
            </div>
            <div>
              <span>ونقدم</span>
              <span>بثقة.</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Hero Canvas Frame Animation Script -->
  <script>
    (function() {
      // Configuration
      const TOTAL_FRAMES = 227;
      const FRAME_PATH = 'img/';
      const FRAME_EXTENSION = '.webp';
      
      // DOM Elements
      const canvas = document.getElementById('hero-canvas');
      const heroSection = document.getElementById('hero-section');
      const scrollTooltip = document.getElementById('scroll-tooltip');
      const loadingIndicator = document.getElementById('loading');
      const textSlides = document.querySelectorAll('.text-slide');
      
      if (!canvas || !heroSection) return;
      
      const ctx = canvas.getContext('2d');
      let frames = [];
      let currentFrame = 0;
      let isLoaded = false;
      let loadedCount = 0;
      
      // Set canvas size
      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        if (isLoaded && frames[currentFrame] && frames[currentFrame].complete) {
          drawFrame(currentFrame);
        }
      }
      
      // Generate frame filename (0001.webp, 0002.webp, etc.)
      function getFrameFilename(index) {
        const num = (index + 1).toString().padStart(4, '0');
        return FRAME_PATH + num + FRAME_EXTENSION;
      }
      
      // Draw frame on canvas
      function drawFrame(frameIndex) {
        if (!frames[frameIndex] || !frames[frameIndex].complete) return;
        
        const img = frames[frameIndex];
        const canvasRatio = canvas.width / canvas.height;
        const imgRatio = img.width / img.height;
        
        let drawWidth, drawHeight, offsetX, offsetY;
        
        if (canvasRatio > imgRatio) {
          drawWidth = canvas.width;
          drawHeight = canvas.width / imgRatio;
          offsetX = 0;
          offsetY = (canvas.height - drawHeight) / 2;
        } else {
          drawHeight = canvas.height;
          drawWidth = canvas.height * imgRatio;
          offsetX = (canvas.width - drawWidth) / 2;
          offsetY = 0;
        }
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, offsetX, offsetY, drawWidth, drawHeight);
      }
      
      // Preload frames
      function preloadFrames() {
        let loadedImages = 0;
        
        for (let i = 0; i < TOTAL_FRAMES; i++) {
          const img = new Image();
          img.src = getFrameFilename(i);
          
          img.onload = function() {
            loadedImages++;
            loadedCount++;
            
            // Draw first frame as soon as it's loaded
            if (loadedImages === 1) {
              if (loadingIndicator) loadingIndicator.style.display = 'none';
              drawFrame(0);
            }
            
            // Mark as fully loaded when all frames are ready
            if (loadedImages === TOTAL_FRAMES) {
              isLoaded = true;
              console.log('All frames loaded');
            }
          };
          
          img.onerror = function() {
            console.error('Failed to load frame:', getFrameFilename(i));
            loadedImages++;
          };
          
          frames.push(img);
        }
      }
      
      // Update text visibility based on scroll progress
      function updateTextVisibility(progress) {
        if (!textSlides || textSlides.length === 0) return;
        
        // Divide scroll into segments for text slides
        const segmentSize = 1 / textSlides.length;
        
        textSlides.forEach((slide, index) => {
          const segmentStart = index * segmentSize;
          const segmentEnd = (index + 1) * segmentSize;
          const segmentProgress = (progress - segmentStart) / segmentSize;
          
          if (progress >= segmentStart && progress < segmentEnd) {
            // Fade in at start of segment, fade out at end
            let opacity = 1;
            if (segmentProgress < 0.15) {
              opacity = segmentProgress / 0.15;
            } else if (segmentProgress > 0.75) {
              opacity = 1 - (segmentProgress - 0.75) / 0.25;
            }
            slide.style.opacity = Math.max(0, Math.min(1, opacity));
          } else {
            slide.style.opacity = 0;
          }
        });
      }
      
      // Handle scroll
      function handleScroll() {
        const rect = heroSection.getBoundingClientRect();
        const sectionHeight = heroSection.offsetHeight;
        const viewportHeight = window.innerHeight;
        
        // Calculate scroll progress within the hero section (0 to 1)
        const scrolled = -rect.top;
        const scrollableHeight = sectionHeight - viewportHeight;
        let progress = Math.max(0, Math.min(1, scrolled / scrollableHeight));
        
        // Calculate frame index
        const frameIndex = Math.floor(progress * (TOTAL_FRAMES - 1));
        
        if (frameIndex !== currentFrame && frameIndex >= 0 && frameIndex < TOTAL_FRAMES) {
          currentFrame = frameIndex;
          if (frames[currentFrame] && frames[currentFrame].complete) {
            drawFrame(currentFrame);
          }
        }
        
        // Update text visibility
        updateTextVisibility(progress);
        
        // Show/hide scroll tooltip
        if (scrollTooltip) {
          if (progress < 0.05) {
            scrollTooltip.classList.add('visible');
          } else {
            scrollTooltip.classList.remove('visible');
          }
        }
      }
      
      // Initialize
      resizeCanvas();
      preloadFrames();
      
      // Event listeners
      window.addEventListener('resize', resizeCanvas);
      window.addEventListener('scroll', handleScroll, { passive: true });
      
      // Initial call
      handleScroll();
      
      // Show tooltip after a short delay
      setTimeout(() => {
        if (scrollTooltip) scrollTooltip.classList.add('visible');
      }, 500);
    })();
  </script>
</body>
</html>
